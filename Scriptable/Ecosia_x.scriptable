{
  "always_run_in_app" : false,
  "icon" : {
    "color" : "deep-green",
    "glyph" : "tree"
  },
  "name" : "Ecosia_x",
  "script" : "\/\/ Scriptableä½¿ç”¨çš„å˜é‡;\n\/\/ Ecosiaæ˜¯ä¸€ä¸ªæ€»éƒ¨ä½äºå¾·å›½æŸæ—çš„æœç´¢å¼•æ“ï¼Œå®ƒä»¬å°†è‡³å°‘80%çš„åˆ©æ¶¦æèµ ç»™éè¥åˆ©ç»„ç»‡ï¼Œç”¨äºç§æ¤æ ‘æœ¨ã€‚è¯¥ç»„ä»¶ç”¨äºæ˜¾ç¤ºè´¦æˆ·æ¤æ ‘æ•°æ®;\n\/\/ å¯æ­é…å¿«æ·æœç´¢è„šæœ¬è®¾ç½®ä¸ºé»˜è®¤æœç´¢å¼•æ“ä½“éªŒæ›´ä½³ https:\/\/raw.githubusercontent.com\/githubdulong\/Script\/master\/Surge\/Q-Search_All_in_one.sgmodule;\n\n\/\/ 1.1.4ç‰ˆæœ¬ \"ä¿®æ”¹æ±‰åŒ–è‡ª https:\/\/www.scriptables.net\";\n\n\/\/ ç¬¬ä¸€æ­¥ï¼šå…ˆç™»é™† https:\/\/www.ecosia.org å†é€šè¿‡Safariå…±äº«èœå•ä½¿ç”¨å¿«æ·æ–¹å¼è·å–ä»¤ç‰Œï¼šhttps:\/\/www.icloud.com\/shortcuts\/8e3d009ee2a94c2d99d3cdb02f3e16d9;\n\n\/\/ ç¬¬äºŒæ­¥ï¼šå°†è·å–åˆ°çš„ä»¤ç‰Œå¡«å…¥ Scriptable > Parameter;\n\nlet widgetInputRAW = args.widgetParameter;\n\nlet token;\nif (widgetInputRAW !== null) {\n  token = widgetInputRAW.toString().trim();\n  if (\/^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$\/.test(token) === false) {\t  \n    throw new Errpr('ä»¤ç‰Œæ ¼å¼æ— æ•ˆ')\n  }\n} else {\n  token = \"40fd8a86-897a-11ec-a2b8-8fc2ec8aa88b\";\n  console.log('æ²¡æœ‰é€šè¿‡å°éƒ¨ä»¶å‚æ•°è®¾ç½®ä»¤ç‰Œ,å°†ä½¿ç”¨é»˜è®¤ä»¤ç‰Œè¿›è¡Œå±•ç¤ºã€‚\\n')\n  \/\/throw new Error('æ²¡æœ‰é€šè¿‡å°éƒ¨ä»¶å‚æ•°è®¾ç½®ä»¤ç‰Œï¼æ‚¨å¯ä»¥åœ¨æ­¤å¤„è¯·æ±‚ä»¤ç‰Œï¼šhttps:\/\/www.ecosia.org\/account\/login')\n}\n\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\n\n\/\/ä¸»é¢˜é¢œè‰²è®¾å®š\nconst themes = {\n  light: {\n    background: new Color('#229954'),\/\/æ˜äº®èƒŒæ™¯\n    textColor: new Color('#000', 0.8),\/\/æ˜äº®æ–‡å­—ï¼Œè’™å±‚é€æ˜åº¦\n    color: Color.black()\n  },\n  dark: {\n    background: new Color('#282828', 1),\/\/æš—é»‘èƒŒæ™¯\n    textColor: new Color('#FFFFFF', 0.8),\/\/æš—é»‘æ–‡å­—ï¼Œè’™å±‚é€æ˜åº¦\n    color: Color.white()\n  }\n};\n\n\/\/è¯»å–ä¸»é¢˜\nconst conf = {\n  client: 'h5',\n  theme: 'system'\n};\n\n\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\nasync function getTreeCounter(token) {\n  try {\n    const url = \"https:\/\/api.ecosia.org\/v1\/accounts\/v2\/personal_counter?token=\" + token\n    let req = new Request(url)\n    let res = await req.loadJSON()\n    return parseInt(res.personal_counter)\n  } catch (error) {\n    throw new Error('An error occurred when loading data from the Ecosia API. Please check the entered token.')\n  }\n}\n\nasync function getLogo() {\n  let fm = FileManager.local()\n  const pathLogo = fm.joinPath(fm.temporaryDirectory(), 'ecosiaLogo')\n\n  if (fm.fileExists(pathLogo)) {\n    return fm.readImage(pathLogo)\n  } else {\n    try {\n      let req = new Request('https:\/\/raw.githubusercontent.com\/ThisIsBenny\/iOS-Widgets\/main\/Ecosia\/logo.png') \/\/logo\n      let logo = await req.loadImage()\n      fm.writeImage(pathLogo, logo)\n      return logo\n    } catch (e) {\n      console.error(e)\n      return null\n    }\n  }\n}\nconsole.log('Load Tree Counter')\nlet treeCounter = await getTreeCounter(token);\nconsole.log('Tree Counter loaded')\nconsole.log(treeCounter)\nconsole.log('Load Logo')\nlet ecosiaLogo = await getLogo()\nconsole.log('Logo loaded')\n\/\/ Create Widget\nlet widget = new ListWidget();\nwidget.url = 'https:\/\/ecosia.org\/'\nwidget.setPadding(10, 10, 10, 10)\n\nif (ecosiaLogo !== null) {\n  let titleLogo = widget.addImage(ecosiaLogo)\n  titleLogo.imageSize = new Size(50, 50)\n  titleLogo.rightAlignImage()\n  if (config.widgetFamily === 'large') {\n    widget.addSpacer()\n  } else {\n    widget.addSpacer(5)\n  }\n} else {\n  let title = widget.addText(\"Ecosia\")\n  title.font = Font.mediumSystemFont(12)\n  title.textColor = new Color(textColor)\n  widget.addSpacer()\n}\n\nlet counterText = widget.addText(`${treeCounter.toLocaleString(Device.locale().replace('_', '-'))} ğŸŒ²`) \/\/ğŸŒ³ğŸŒ´\ncounterText.font = Font.regularSystemFont(36)\ncounterText.minimumScaleFactor = 0.7;\ncounterText.lineLimit = 1\ncounterText.centerAlignText()\n\n\/\/å®šä¹‰èƒŒæ™¯é¢œè‰²\nwidget.backgroundColor = conf.theme === 'system'\n    ? Color.dynamic(themes.light.background, themes.dark.background)\n    : themes[conf.theme].background;\n\n\/\/å®šä¹‰å­—ä½“é¢œè‰²\ncounterText.textColor = conf.theme === 'system'\n    ? Color.dynamic(themes.light.textColor, themes.dark.textColor)\n    : themes[conf.theme].color;\n\nwidget.addSpacer()\n\nif (!config.runsInWidget) {\n  await widget.presentSmall()\n} else {\n\/\/   Tell the system to show the widget.\n  Script.setWidget(widget)\n  Script.complete()\n}\n",
  "share_sheet_inputs" : [

  ]
}